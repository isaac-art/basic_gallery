webpackJsonp([1],{0:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),a=n("Xxa5"),i=n.n(a),s=n("exGp"),o=n.n(s),c=n("QjMU"),u=n("mtWM"),d=n.n(u),p={data:function(){return{ubg_address:"0x45527f75E9e69900Dd1A9C9e8af1240D4C5C9E89",ubi_address:"0xdd1ad9a21ce722c151a836373babe42c868ce9a4",ubg_abi:["event Displaying(address _sender, address _nft, uint256 index)","function activeNFTindex() public view returns (uint256)","function lastUpdate() public view returns (uint256)","function cost() public view returns (uint256)","function display(address _add, uint256 _idx) external","function tally() public view returns (uint256)","function name() public view returns (string memory)","function symbol() public view returns (string memory)","function tokenURI(uint256 tokenId) public view returns (string memory)","function burnPaymentToken() external","function updatePrice() external"],ubi_abi:["function approve(address _spender, uint256 _amount) public returns (bool)","function allowance(address _sender, address _spender) public view returns (uint256)"],ubg:!1,name:"",costdeci:!1,cost:!1,tokenURI:!1,image:!1,lastUpdate:!1,idx:!1,description:!1,approved:!1,approveText:"APPROVE UBI",displayText:"DISPLAY NFT",new_nft_id:null,new_nft_address:"",prev:"",logs:!1,connected:!1,tally:0,provider:!1,ubiContract:!1,ubiWithSigner:!1,ubgContract:!1,ubgWithSigner:!1}},mounted:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("connecting to mm"),window.ethereum.enable(),t.next=4,new c.a.providers.Web3Provider(window.ethereum);case 4:return e.provider=t.sent,t.next=7,e.provider.getSigner();case 7:e.signer=t.sent,e.ubiContract=new c.a.Contract(e.ubi_address,e.ubi_abi,e.provider),e.ubiWithSigner=e.ubiContract.connect(e.signer),e.ubgContract=new c.a.Contract(e.ubg_address,e.ubg_abi,e.provider),e.ubgWithSigner=e.ubgContract.connect(e.signer),e.connected=!0,e.getActiveTokenLoop();case 14:case"end":return t.stop()}},t,e)}))()},methods:{checkUBIApproved:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.signer.getAddress().then(function(t){return e.ubiContract.allowance(t,e.ubg_address).then(function(t){t.eq(e.costdeci)&&(e.approved=!0)})});case 1:case"end":return t.stop()}},t,e)}))()},approveUBI:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.approveText="APPROVING",e.ubiWithSigner.approve(e.ubg_address,e.costdeci).then(function(t){e.checkUBIApproved()});case 2:case"end":return t.stop()}},t,e)}))()},displayNewNFT:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.displayText="UPDATING",e.ubgWithSigner.display(e.new_nft_address,e.new_nft_id).then(function(e){console.log(e)}).catch(function(e){console.log(e)});case 2:case"end":return t.stop()}},t,e)}))()},getLogs:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ubgContract.queryFilter("Displaying",12800929,"latest").then(function(e){return console.log(e),e});case 2:e.logs=t.sent;case 3:case"end":return t.stop()}},t,e)}))()},getActiveTokenLoop:function(){var e=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ubgContract.name();case 2:if(e.name=t.sent,e.name==e.prev){t.next=32;break}return e.getLogs(),t.next=7,e.ubgContract.activeNFTindex();case 7:return e.idx=t.sent,t.next=10,e.ubgContract.tokenURI(0);case 10:return e.tokenURI=t.sent,t.next=13,e.ubgContract.cost();case 13:return e.costdeci=t.sent,t.t0=c.a.utils,t.next=17,e.ubgContract.tally();case 17:return t.t1=t.sent,e.tally=t.t0.formatEther.call(t.t0,t.t1),e.cost=c.a.utils.formatEther(e.costdeci),t.next=22,e.ubgContract.lastUpdate();case 22:return e.lastUpdate=t.sent,e.connected&&e.checkUBIApproved(),"ipfs://"==e.tokenURI.substring(0,7)&&(e.isIPFS=!0,e.tokenURI=e.tokenURI.replace("ipfs://",""),e.tokenURI=e.tokenURI.replace("ipfs/",""),e.tokenURI="https://ipfs.io/ipfs/"+e.tokenURI),console.log("loading metadata",e.tokenURI),t.next=28,d.a.get(e.tokenURI).then(function(){var t=o()(i.a.mark(function t(n){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n.data),e.isIPFS?(r=(r=n.data.image.replace("ipfs://","")).replace("ipfs/",""),e.image="https://ipfs.io/ipfs/"+r):e.image=n.data.image,e.description=n.data.description,void 0!==n.data.name&&void 0===n.data.description&&(e.description=n.data.name),t.abrupt("return",n);case 5:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){return console.log(e),!1});case 28:t.sent,e.prev=e.name,t.next=33;break;case 32:console.log("no change");case 33:setTimeout(e.getActiveTokenLoop,14e3);case 34:case"end":return t.stop()}},t,e)}))()}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[e.image?n("img",{attrs:{src:e.image}}):e._e(),e._v(" "),n("h1",[e._v(e._s(e.name)+" "),e.idx?n("span",[e._v("#"+e._s(e.idx))]):e._e()]),e._v(" "),e.description?n("p",{staticClass:"description"},[e._v(e._s(e.description))]):e._e(),e._v(" "),n("br"),e._v(" "),n("hr"),e._v(" "),n("br"),e._v(" "),n("p",[e._v("The artwork on display can be changed by burning UBI tokens via the gallery contract."),n("br"),n("br"),e._v(" \n  The price will increase by 24 UBI with each new display, and half every 24 hours."),n("br"),n("br"),e._v("\n  Click below to approve burning UBI with the gallery contract, and then choose a new NFT to display for a cost of "),e.cost?n("span",[e._v(e._s(e.cost))]):n("span",[e._v("...")]),e._v(" UBI. "),n("br"),n("br")]),e._v(" "),0==e.connected?n("div",[n("button",{on:{click:function(t){return e.connectWallet()}}},[e._v("CONNECT WALLET")])]):n("div",{attrs:{id:"displayWindow"}},[0==e.approved?n("button",{on:{click:function(t){return e.approveUBI()}}},[e._v(e._s(e.approveText))]):n("div",[n("label",{attrs:{for:"nft_address"}},[e._v("NFT Address")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_nft_address,expression:"new_nft_address"}],attrs:{id:"nft_address",type:"text",placeholder:"0x..."},domProps:{value:e.new_nft_address},on:{input:function(t){t.target.composing||(e.new_nft_address=t.target.value)}}}),e._v(" "),n("br"),e._v(" "),n("label",{attrs:{for:"nft_id"}},[e._v("NFT Number")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_nft_id,expression:"new_nft_id"}],attrs:{id:"nft_id",type:"number",placeholder:"0"},domProps:{value:e.new_nft_id},on:{input:function(t){t.target.composing||(e.new_nft_id=t.target.value)}}}),e._v(" "),n("br"),e._v(" "),n("button",{on:{click:function(t){return e.displayNewNFT()}}},[e._v(e._s(e.displayText))])])]),e._v(" "),n("br"),e._v(" "),n("br"),e._v(" "),n("hr"),e._v(" "),n("br"),n("br"),e._v(" "),n("i",[e._v("UNIVERSAL BASIC GALLERY HAS BURNT "+e._s(e.tally/24)+" DAYS OF UBI")]),n("br"),e._v(" "),n("a",{attrs:{href:"https://etherscan.io/address/0x45527f75E9e69900Dd1A9C9e8af1240D4C5C9E89"}},[e._v("CONTRACT 0x45527f75E9e69900Dd1A9C9e8af1240D4C5C9E89")]),e._v(" "),n("br"),n("br"),n("br"),e._v(" "),n("table",[e._m(0),e._v(" "),n("tbody",e._l(e.logs,function(t){return n("tr",[n("td",[e._v(e._s(t.blockNumber))]),e._v(" "),n("td",[e._v(e._s(t.args[1]))]),e._v(" "),n("td",[e._v(e._s(t.args[2].toString()))])])}),0)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("th",[this._v("Block")]),this._v(" "),t("th",[this._v("NFT Address")]),this._v(" "),t("th",[this._v("NFT ID")])])}]};var v={name:"App",components:{LiveNFT:n("VU/8")(p,l,!1,function(e){n("NlwT")},"data-v-0b07c30f",null).exports}},_={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("header",[this._v("UNIVERSAL BASIC GALLERY")]),this._v(" "),t("LiveNFT")],1)},staticRenderFns:[]};var f=n("VU/8")(v,_,!1,function(e){n("zwf/")},null,null).exports;r.a.config.productionTip=!1,new r.a({el:"#app",components:{App:f},template:"<App/>"})},NlwT:function(e,t){},"zwf/":function(e,t){}},["NHnr"]);